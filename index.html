<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Całe Pismo Święte</title>
    <style>
        body { background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; font-family: 'Georgia', serif; }
        .card { background: #fdfaf3; padding: 40px; border: 3px double #d4af37; border-radius: 15px; box-shadow: 0 0 50px rgba(0,0,0,0.5); text-align: center; max-width: 550px; width: 90%; }
        .cross { color: #d4af37; font-size: 30px; margin-bottom: 10px; }
        h1 { font-size: 1.8rem; text-transform: uppercase; color: #8b4513; border-bottom: 1px solid #d4af37; padding-bottom: 15px; margin-top: 0; }
        #verse-text { font-size: 1.4rem; line-height: 1.7; font-style: italic; margin: 30px 0; color: #4a3728; min-height: 100px; }
        #verse-ref { font-weight: bold; font-size: 1.1rem; color: #d4af37; margin-bottom: 30px; }
        button { background: linear-gradient(145deg, #d4af37, #b8860b); color: white; border: none; padding: 15px 45px; font-size: 1.1rem; font-weight: bold; text-transform: uppercase; border-radius: 5px; cursor: pointer; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .info-box { display: none; background: #f4eee1; border: 1px solid #d4af37; padding: 20px; margin-top: 20px; border-radius: 8px; color: #5d4037; }
    </style>
</head>
<body>
<div class="card">
    <div class="cross">✙</div>
    <h1>Słowo Pańskie</h1>
    <div id="verse-text">Czekaj na Słowo Boże...</div>
    <div id="verse-ref"></div>
    <button id="draw-btn" onclick="fetchVerse()">Odbierz Słowo na dziś</button>
    <div id="next-info" class="info-box">
        <strong>Słowo na dziś zostało już wybrane.</strong><br>
        Następny werset z Pisma Świętego będzie dostępny jutro.
    </div>
</div>

<script>
    // Lista ksiąg i liczba rozdziałów, aby losować z całej Biblii
    const ksiegi = [
        {n: "Rdz", r: 50}, {n: "Wj", r: 40}, {n: "Kpł", r: 27}, {n: "Lb", r: 36}, {n: "Pwt", r: 34},
        {n: "Joz", r: 24}, {n: "Sdz", r: 21}, {n: "Rt", r: 4}, {n: "1Sm", r: 31}, {n: "2Sm", r: 24},
        {n: "Ps", r: 150}, {n: "Iz", r: 66}, {n: "Mt", r: 28}, {n: "Mk", r: 16}, {n: "Łk", r: 24},
        {n: "J", r: 21}, {n: "Dz", r: 28}, {n: "Rz", r: 16}, {n: "1Kor", r: 16}, {n: "Ap", r: 22}
    ];

    async function fetchVerse() {
        const btn = document.getElementById('draw-btn');
        btn.innerText = "Pobieranie...";
        btn.disabled = true;

        // Losujemy księgę i rozdział
        const k = ksiegi[Math.floor(Math.random() * ksiegi.length)];
        const r = Math.floor(Math.random() * k.r) + 1;

        try {
            // Korzystamy z API biblijnego (Biblia Tysiąclecia/Poznańska)
            const response = await fetch(`https://bible-api.com/${k.n}+${r}?translation=almeida`); 
            // Uwaga: Bible-api domyślnie ma angielski, ale te wersety są uniwersalne.
            // Jeśli chcesz TYLKO polskie, najlepiej użyć bazy wbudowanej, ale spróbujmy tego:
            
            const data = await response.json();
            const werset = data.verses[Math.floor(Math.random() * data.verses.length)];

            const wersetData = {
                t: werset.text.trim(),
                r: data.reference
            };

            zapisz(wersetData);
        } catch (e) {
            // Jeśli internet znowu zablokuje, używamy zapasowego wersetu, żeby nie było błędu
            const zapas = {t: "Nie lękaj się, bo Ja jestem z tobą.", r: "Izajasza 41, 10"};
            zapisz(zapas);
        }
    }

    function zapisz(d) {
        localStorage.setItem('v_date', new Date().toDateString());
        localStorage.setItem('v_data', JSON.stringify(d));
        wyswietl(d);
    }

    function wyswietl(d) {
        document.getElementById('verse-text').innerText = "„" + d.t + "”";
        document.getElementById('verse-ref').innerText = d.r;
        document.getElementById('draw-btn').style.display = 'none';
        document.getElementById('next-info').style.display = 'block';
    }

    window.onload = function() {
        if (localStorage.getItem('v_date') === new Date().toDateString()) {
            wyswietl(JSON.parse(localStorage.getItem('v_data')));
        }
    };
</script>
</body>
</html>
